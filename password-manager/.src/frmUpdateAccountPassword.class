' Gambas class file

Public Sub Form_Open()

  ModDB.Connect()

End

Public Sub btnUpdateNewPasswod_Click()

  Dim res As Result
  
  If txtNewPassword.Text <> txtRepeatNewPassword.Text Then 
    Message.Warning("New password and repeat new password do not match.", "Try again")
    txtCurrentPassword.SetFocus()
    txtCurrentPassword.Clear()
    txtNewPassword.Clear()
    txtRepeatNewPassword.Clear()
  Else 
    
    res = ModDB.$Con.Edit("login", "ID = &1", ModDB.$CurrentUserID)
    
    If res.Available Then 
      res!password = txtNewPassword.Text
      res.Update()
      Message.Info("Password updated successfully!", "OK")
      ModDB.Disconnect()
      Me.Close()
      frmPasswordManager.Show()
    Endif
    
  Endif

End

Public Sub chbShowAllPassword_Click()

  If chbShowAllPassword.Value = True Then 
    txtCurrentPassword.Password = False
    txtNewPassword.password = False
    txtRepeatNewPassword.Password = False
  Else 
    txtCurrentPassword.Password = True
    txtNewPassword.password = True
    txtRepeatNewPassword.Password = True
  Endif

End

Public Sub btnBack_Click()

  ModDB.Disconnect()
  Me.Close()
  frmPasswordManager.Show()

End
