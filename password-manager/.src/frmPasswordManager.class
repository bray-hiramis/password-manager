' Gambas class file

Public Sub btnSavePassword_Click()

  Dim res As Result

  If txtURL.Text = "" Or txtName.Text = "" Or txtPassword.Text = "" Then 
    Message.Warning("All fields are required!")
    Return 
  Endif
  
  res = ModDB.$Con.Create("saved_password")
  res["url"] = txtURL.Text
  res["name"] = txtName.Text
  res["password"] = txtPassword.Text
  
  Try res.Update()
  
  If Error Then 
    Message.Error("Failed to save the password: " & Error.Text)
  Else 
    Message.Info("Password for " & txtURL.Text, " has been saved!")
    txtURL.Clear()
    txtName.Clear()
    txtPassword.Clear()
    
    tabStripPasswordManager.Index = 1
  Endif 
  
End

Public Sub chbShowPassword_Click()

  If chbShowPassword.Value = True Then 
    txtPassword.Password = False
  Else 
    txtPassword.Password = True
  Endif

End
