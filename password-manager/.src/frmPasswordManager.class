' Gambas class file

Public Sub Form_Open()

  ' ModDB.Connect()
  dtSource.Connection = ModDB.$Con
  dtSource.Table = "saved_password"
  dtSource.Filter = "login_id = " & ModDB.$CurrentUserID

End

Public Sub btnSavePassword_Click()

  Dim res As Result
  
  ''' Check if the fields are empty or not
  If txtURL.Text = "" Or txtName.Text = "" Or txtPassword.Text = "" Then 
    Message.Warning("All fields are required!")
    Return 
  Endif
  
  ''' To create a new data provided to the fields
  res = ModDB.$Con.Create("saved_password")
  res["url"] = txtURL.Text
  res["name"] = txtName.Text
  res["password"] = txtPassword.Text
  
  res["login_id"] = ModDB.$CurrentUserID
  
  ''' Update the database
  Try res.Update()
  
  ''' To catch database error
  If Error Then 
    Message.Error("Failed to save the password: " & Error.Text)
  Else 
    Message.Info("Password saved for " & txtURL.Text, " OK")
    txtURL.Clear()
    txtName.Clear()
    txtPassword.Clear()
    
    tabStripPasswordManager.Index = 1
    dtSource.Update()
  Endif 
  
End


Public Sub chbShowPassword_Click()

  If chbShowPassword.Value = True Then 
    txtPassword.Password = False
  Else 
    txtPassword.Password = True
  Endif

End
